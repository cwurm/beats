{{ if .Reference -}}
{{ end -}}
{{ if ne .GOOS "windows" -}}
- module: system

  metricsets:
    - host
    {{ if false -}}
    - packages
    {{- end -}}
    - process
    {{ if eq .GOOS "linux" -}}
    - socket
    - user
    {{- end }}

  state.period: 12h

  {{ if eq .GOOS "linux" -}}
  # Enabled by default. Auditbeat will read password fields in
  # /etc/passwd and /etc/shadow and store a hash locally to
  # detect any changes.
  user.detect_password_changes: true
  {{- end }}
  {{- if false -}}
  {{/* Only remaining use in packages, to be removed completely. */}}
  report_changes: true
  {{- end -}}
{{- end }}
{{ if .Reference }}
{{- end }}
